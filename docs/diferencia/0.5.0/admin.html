<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Administration Console :: Diferencia Docs</title>
    <link rel="canonical" href="http://lordofthejars.github.io/diferenciadoc/diferencia/0.6.0/admin.html">
    <meta name="generator" content="Antora 2.0.0">
    <link rel="stylesheet" href="../../_/css/site.css">
<link rel="icon" href="../../_/img/favicon.ico" type="image/x-icon">  </head>
  <body class="article">
<header class="header" role="banner">
  <nav class="navbar">
    <div class="navbar-brand">
      <div class="navbar-item">
        <a href="#">Diferencia</a>
        <span class="separator">//</span>
        <a href="http://lordofthejars.github.io/diferenciadoc">Docs</a>
      </div>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <div class="navbar-item has-dropdown is-hoverable">
          <div class="navbar-link">Project</div>
          <div class="navbar-dropdown">
            <div class="navbar-item"><strong>GitHub</strong></div>
            <a class="navbar-item" href="https://github.com/lordofthejars/diferencia">Diferencia Repository</a>
            <a class="navbar-item" href="https://github.com/lordofthejars/diferencia/issues">Diferencia Issue Tracker</a>
          </div>
        </div>
        <a class="navbar-item" href="https://twitter.com/alexsotob">
          <span class="icon">
            <svg aria-hidden="true" data-icon="twitter" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
              <path fill="#57aaee" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path>
            </svg>
          </span>
        </a>
      </div>
    </div>
  </nav>
</header>
<div class="main-wrapper">
<div class="navigation-container" data-component="diferencia" data-version="0.5.0">
  <aside class="navigation">
    <div class="panels">
<div class="navigation-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="index.html">Diferencia</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="index.html">Introduction to Diferencia</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="why.html">Why Diferencia</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="why.html#opendiffy">Based on OpenDiffy</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <span class="nav-text">Get Diferencia</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="supported-platforms.html">System Requirements</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="installation.html">Install</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="installation.html#docker">Docker</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="run-diferencia.html">Run Diferencia</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="run-diferencia.html#modes">Running Modes</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="run-diferencia.html#strict">Strict</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="run-diferencia.html#subset">Subset</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="run-diferencia.html#noise">Noise Detection</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https.html">Https</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="prometheus.html">Prometheus</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="run-diferencia.html#configuration">Configuration</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="run_docker.html">Run In Docker</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <span class="nav-text">Administration Console</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#admin-configuration">Configuration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#stats-configuration">Stats</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <span class="nav-text">Experimental</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="plain_text.html">Plain Text Comparision</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="what_next.html">What&#8217;s Next</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="navigation-explore" data-panel="explore">
  <div class="context">
    <span class="title">Diferencia</span>
    <span class="version">0.5.0</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">Diferencia</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../0.6.0/index.html">0.6.0</a>
        </li>
        <li class="version is-current">
          <a href="index.html">0.5.0</a>
        </li>
        <li class="version">
          <a href="../0.4.1/index.html">0.4.1</a>
        </li>
        <li class="version">
          <a href="../0.4.0/index.html">0.4.0</a>
        </li>
        <li class="version">
          <a href="../0.3.0/index.html">0.3.0</a>
        </li>
        <li class="version">
          <a href="../0.2.0/index.html">0.2.0</a>
        </li>
        <li class="version">
          <a href="../0.1.0/index.html">0.1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Diferencia Java</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../diferencia-java/0.6.0/index.html">0.6.0</a>
        </li>
        <li class="version">
          <a href="../../diferencia-java/0.5.0/index.html">0.5.0</a>
        </li>
        <li class="version">
          <a href="../../diferencia-java/0.4.0/index.html">0.4.0</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
  <main class="main">
<div class="toolbar" role="navigation">
  <button class="navigation-toggle"></button>
  <a href="../0.6.0/index.html" class="home-link"></a>
<nav class="crumbs" aria-label="breadcrumbs">
  <ul>
    <li class="crumb"><a href="index.html">Diferencia</a></li>
    <li class="crumb">Administration Console</li>
    <li class="crumb"><a href="#admin-configuration">Configuration</a></li>
  </ul>
</nav>
<div class="page-versions">
  <button class="versions-menu-toggle" title="Show other versions of page">0.5.0</button>
  <div class="versions-menu">
    <a class="version" href="../0.6.0/admin.html">0.6.0</a>
    <a class="version is-current" href="admin.html">0.5.0</a>
    <a class="version" href="../0.4.1/admin.html">0.4.1</a>
    <a class="version" href="../0.4.0/admin.html">0.4.0</a>
    <a class="version" href="../0.3.0/admin.html">0.3.0</a>
    <a class="version is-missing" href="../0.2.0/index.html">0.2.0</a>
    <a class="version is-missing" href="../0.1.0/index.html">0.1.0</a>
  </div>
</div>
  <div class="edit-this-page"><a href="https://github.com/lordofthejars/diferencia/blob/v0.5.0/docs/modules/ROOT/pages/admin.adoc">Edit this Page</a></div>
</div>
<article class="doc">
<h1>Administration Console</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Assumptions:</p>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> You have Diferencia running (in case of Docker with admin port exposed). Default admin port is <code>8082</code>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="admin-configuration"><a class="anchor" href="#admin-configuration"></a>Configuration</h2>
<div class="sectionbody">
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
By default the admin console is listening port <code>8082</code> but it can be configured by using <code>--adminPort</code> argument.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_rest_api"><a class="anchor" href="#_rest_api"></a>Rest API</h3>
<div class="sect3">
<h4 id="_getting_configuration"><a class="anchor" href="#_getting_configuration"></a>Getting Configuration</h4>
<div class="paragraph">
<p>Diferencia has an administration console that can be accessed as a Rest API to get configuration values.
To get it you need to use <code>GET</code> http method to <code>/configuration</code> endpoint to given host and configured port.</p>
</div>
<div class="paragraph">
<p>The JSON document of response is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "port": 8080,
  "serviceName": "now.httpbin.org",
  "primary": "http://now.httpbin.org/",
  "secondary": "http://now.httpbin.org",
  "candidate": "http://now.httpbin.org/",
  "prometheusPort": 8081,
  "adminPort": 8082
  ... <i class="conum" data-value="1"></i><b>(1)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>All configuration parameters are exposed using camel case.</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_updating_configuration"><a class="anchor" href="#_updating_configuration"></a>Updating Configuration</h4>
<div class="paragraph">
<p>Diferencia has an administration console that can be accessed as a Rest API to configure some of the Diferencia parameters without having to restart it.
At this time these parameters are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>serviceName</p>
</li>
<li>
<p>primary</p>
</li>
<li>
<p>candidate</p>
</li>
<li>
<p>secondary</p>
</li>
<li>
<p>noise detection</p>
</li>
<li>
<p>mode</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To update any of the parameters you only need to send a JSON document using <code>PUT</code> http method to <code>/configuration</code> endpoint to given host and configured port.</p>
</div>
<div class="paragraph">
<p>The JSON document must follow next schema:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "serviceName" : "",
  "primary" : "",
  "secondary" : "",
  "candidate" : "",
  "secondary" : "",
  "noiseDetection" : "", <i class="conum" data-value="1"></i><b>(1)</b>
  "mode" : "" <i class="conum" data-value="2"></i><b>(2)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Noise Detection valid values is: <code>Strict</code>, <code>Subset</code> and <code>Schema</code></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Boolean as string <code>true</code> or <code>false</code></td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You can set all parameters to be updated in the document, and all of them will be updated at once. It is not necessary to send N requests one for each change.
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/confupdate.png" alt="confupdate">
</div>
<div class="title">Figure 1. Update Noise Cancellation with Insomnia</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_dashboard"><a class="anchor" href="#_dashboard"></a>Dashboard</h3>
<div class="paragraph">
<p>You can access to Dashboard using a browser to have a web view of basic configuration parameters.
You need to access to <code>/dashboard/</code> and a dashboard web page with error endpoints is shown.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="stats-configuration"><a class="anchor" href="#stats-configuration"></a>Stats</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_rest_api_2"><a class="anchor" href="#_rest_api_2"></a>Rest API</h3>
<div class="sect3">
<h4 id="_getting_stats"><a class="anchor" href="#_getting_stats"></a>Getting Stats</h4>
<div class="paragraph">
<p>Diferencia collects stats of the failing endpoints so you can get which endpoints are failing and how many times they have failed.
In future, these stats can be improved offering more information, for now it just offers basic information.</p>
</div>
<div class="paragraph">
<p>To get stats you only need to use <code>GET</code> http method to <code>/stats</code> endpoint to given host and configured port.</p>
</div>
<div class="paragraph">
<p>And the response is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">[
	{
		"endpoint": {
			"method": "GET", <i class="conum" data-value="1"></i><b>(1)</b>
			"path": "/" <i class="conum" data-value="2"></i><b>(2)</b>
		},
		"errors": 5 <i class="conum" data-value="3"></i><b>(3)</b>
	}
]</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Http method used in request</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Path used to replicate</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Number of errors</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Only endpoints with errors are returned, if there is no errors then empy array is returned.
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/stats.png" alt="stats">
</div>
<div class="title">Figure 2. Stats call with Insomnia</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_dashboard_2"><a class="anchor" href="#_dashboard_2"></a>Dashboard</h3>
<div class="paragraph">
<p>You can access to Dashboard using a browser to have a web view of what&#8217;s happening in Diferencia.
You need to access to <code>/dashboard/</code> and a dashboard web page with error endpoints is shown.</p>
</div>
</div>
</div>
</div>
</article>
  </main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script src="../../_/js/site.js"></script>
<script src="../../_/js/vendor/highlight.js"></script>
<script>hljs.initHighlighting()</script>
  </body>
</html>
